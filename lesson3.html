<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Lesson 3 ‚Äî Safe or risky?</title>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<style>
  :root{
    --bg:#0f1115; --card:#171a21; --text:#e7eaf0; --muted:#9aa3b2;
    --brand:#B1FF8C; --ink:#0b0e11; --line:#242936; --danger:#ff6b6b;
    --btn-h:52px; --btn-fs:16px;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:var(--bg);color:var(--text);
       font:15px/1.5 system-ui,-apple-system,"Segoe UI",Roboto,Inter,Arial,sans-serif}
  a{color:inherit;text-decoration:none}

  /* Header (–∫–∞–∫ –≤ –¥—Ä—É–≥–∏—Ö —É—Ä–æ–∫–∞—Ö) */
  .bar{
    position:relative; display:flex; align-items:center; justify-content:space-between;
    padding:12px 16px; background:var(--bg);
  }
  .back{font-size:24px;line-height:1}
  .logo{height:44px;width:auto;object-fit:contain;display:block}
  @media (max-width:480px){.logo{height:36px}}

  .wrap{max-width:980px;margin:0 auto;padding:10px 16px 40px}

  /* Title */
  .eyebrow{margin-top:8px;text-align:center;color:var(--muted);font-weight:600}
  .title{margin:6px auto 6px;text-align:center;max-width:720px;
         font-family:Georgia,serif;font-style:italic;font-size:28px;line-height:1.25;font-weight:600}
  .sub{color:var(--muted);text-align:center;max-width:820px;margin:0 auto 12px}
  .sub .accent{color:#9dc8ff;font-weight:700}

  /* Areas */
  .bank, .board{background:#0d1219;border:1px solid var(--line);border-radius:16px}
  .bank{padding:14px;display:flex;flex-wrap:wrap;gap:12px;min-height:92px}
  .board{display:grid;grid-template-columns:1fr 1fr;gap:14px;padding:14px;margin-top:16px}
  @media (max-width:720px){.board{grid-template-columns:1fr}}

  .col{background:#0b1118;border:1px solid var(--line);border-radius:14px;padding:14px;display:flex;flex-direction:column;gap:10px;min-height:220px}
  .col h3{display:flex;align-items:center;gap:10px;margin:0 0 6px;font-size:20px}
  .hint{color:var(--muted);font-size:13px;margin:0 0 12px}

  /* Chips */
  .chip{
    user-select:none;-webkit-user-drag:element;
    display:inline-flex;align-items:center;justify-content:center;
    padding:10px 14px;border-radius:12px;background:#111824;border:1px solid #243044;
    color:var(--text);font-weight:600;cursor:grab;box-shadow:0 2px 8px rgba(0,0,0,.25);
    transition:transform .1s ease, border-color .15s ease, background .15s ease;
  }
  .chip:active{cursor:grabbing;transform:scale(.98)}
  .chip.wrong{border-color:var(--danger); box-shadow:0 0 0 2px rgba(255,107,107,.25)}
  .chip.correct{border-color:rgba(177,255,140,.55)}
  .dropping{outline:2px dashed rgba(177,255,140,.45); outline-offset:-6px}

  /* CTA */
  .cta{display:flex;justify-content:center;margin:18px 0 4px}
  .btn{
    display:inline-flex;align-items:center;justify-content:center;gap:8px;
    height:var(--btn-h); padding:0 28px;border:0;border-radius:999px;
    background:var(--brand); color:#07110c;font-size:var(--btn-fs);font-weight:800;line-height:1;
    box-shadow:0 6px 14px rgba(177,255,140,.25); cursor:pointer;
  }
  .btn.secondary{background:#1a2230;color:var(--text);border:1px solid var(--line);box-shadow:none}

  .banner{margin:14px auto 10px;max-width:860px;padding:12px 14px;border-radius:14px;border:1px solid #3a4457;background:#101722;color:#cfd7e3;text-align:center}
  .banner.ok{background:rgba(177,255,140,.12);border-color:rgba(177,255,140,.4);color:#eaffd9}

  /* Accessibility helpers for keyboard */
  .col, .bank{scroll-margin:80px}
</style>
</head>
<body>
  <header class="bar">
    <a href="index.html" class="back" aria-label="Back" onclick="pickleBack();return false;">‚Üê</a>
    <img src="assets/logo-changelly.png" alt="Changelly" class="logo">
  </header>

  <main class="wrap">
    <div class="eyebrow">Lesson 3</div>
    <h1 class="title">Safe or risky?</h1>
    <p class="sub">Can you tell the difference between smart security moves and beginner mistakes?
      <span class="accent">Drag each item</span> into one of these two boxes:</p>

    <!-- Start pool -->
    <section id="bank" class="bank" aria-label="Items to sort"></section>

    <!-- Drop board -->
    <section class="board" aria-label="Drop zones">
      <div id="safe" class="col" aria-label="Safe practice" data-expect="safe">
        <h3>üõ°Ô∏è Safe practice</h3>
        <p class="hint">Drop the security best-practices here</p>
      </div>
      <div id="risky" class="col" aria-label="Risky behavior" data-expect="risky">
        <h3>‚ö†Ô∏è Risky behavior</h3>
        <p class="hint">Drop the beginner mistakes here</p>
      </div>
    </section>

    <div id="banner" class="banner" style="display:none"></div>

    <div class="cta">
      <button id="check" class="btn">Check answers</button>
      <a id="next" class="btn" style="display:none; margin-left:10px">Crushed it! Let‚Äôs roll</a>
    </div>
  </main>

<script>
(function(){
  // ------- data -------
  const items = [
    { id:'i1', txt:'Use a hardware wallet', answer:'safe' },
    { id:'i2', txt:'Use a cold wallet for large funds', answer:'safe' },
    { id:'i3', txt:'Store your seed phrase offline', answer:'safe' },
    { id:'i4', txt:'Enable 2FA on exchanges', answer:'safe' },
    { id:'i5', txt:'Click random airdrop links', answer:'risky' },
    { id:'i6', txt:'Sign unknown transactions', answer:'risky' },
    { id:'i7', txt:'Keep all assets in a hot wallet', answer:'risky' },
    { id:'i8', txt:'Share your seed phrase in a Google Doc', answer:'risky' },
  ];

  const bank = document.getElementById('bank');
  const safe = document.getElementById('safe');
  const risky = document.getElementById('risky');
  const banner = document.getElementById('banner');
  const checkBtn = document.getElementById('check');
  const nextBtn = document.getElementById('next');

  // create chips
  for (const it of items) {
    const el = document.createElement('div');
    el.className = 'chip';
    el.textContent = it.txt;
    el.id = it.id;
    el.draggable = true;
    el.dataset.answer = it.answer;
    bank.appendChild(el);
  }

  // DnD helpers
  let dragId = null;
  document.addEventListener('dragstart', (e)=>{
    const chip = e.target.closest('.chip');
    if (!chip) return;
    dragId = chip.id;
    e.dataTransfer.setData('text/plain', chip.id);
    e.dataTransfer.effectAllowed = 'move';
  });
  function allow(e){
    e.preventDefault();
    const zone = e.currentTarget;
    zone.classList.add('dropping');
  }
  function leave(e){ e.currentTarget.classList.remove('dropping'); }
  function dropTo(e){
    e.preventDefault();
    const zone = e.currentTarget;
    zone.classList.remove('dropping');
    const id = e.dataTransfer.getData('text/plain') || dragId;
    const chip = document.getElementById(id);
    if (!chip) return;
    zone.appendChild(chip);
    tidy();
  }
  [bank,safe,risky].forEach(z=>{
    z.addEventListener('dragover', allow);
    z.addEventListener('dragleave', leave);
    z.addEventListener('drop', dropTo);
  });

  // Tap-cycling (pool -> safe -> risky -> pool)
  const order = [bank, safe, risky];
  document.addEventListener('click', (e)=>{
    const chip = e.target.closest('.chip');
    if (!chip) return;
    const parent = chip.parentElement;
    const idx = order.indexOf(parent);
    const next = order[(idx + 1) % order.length];
    next.appendChild(chip);
    tidy();
  });

  function tidy(){
    // —Å–Ω—è—Ç—å –ø–æ–¥—Å–≤–µ—Ç–∫–∏ –∏ –±–∞–Ω–Ω–µ—Ä –ø—Ä–∏ –ª—é–±–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏
    banner.style.display = 'none';
    nextBtn.style.display = 'none';
    checkBtn.style.display = 'inline-flex';
    document.querySelectorAll('.chip').forEach(c=>c.classList.remove('wrong','correct'));
  }

  function allPlaced(){
    return bank.querySelectorAll('.chip').length === 0;
  }

  function check(){
    let wrong = 0, correct = 0;
    // –æ—á–∏—Å—Ç–∏—Ç—å –ø—Ä–æ—à–ª—É—é –ø–æ–¥—Å–≤–µ—Ç–∫—É
    document.querySelectorAll('.chip').forEach(c=>c.classList.remove('wrong','correct'));

    // –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∫–∞–∂–¥–æ–π –∫–æ–ª–æ–Ω–∫–µ
    [[safe,'safe'], [risky,'risky']].forEach(([col, expected])=>{
      col.querySelectorAll('.chip').forEach(chip=>{
        if (chip.dataset.answer === expected) { chip.classList.add('correct'); correct++; }
        else { chip.classList.add('wrong'); wrong++; }
      });
    });

    // –≤—Å—ë –∏–∑ –±–∞–Ω–∫–∞ ‚Äî —ç—Ç–æ –Ω–µ–≤–µ—Ä–Ω–æ/–Ω–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–æ
    wrong += bank.querySelectorAll('.chip').length;

    if (!allPlaced()){
      banner.className = 'banner';
      banner.textContent = 'Place every item into one of the boxes first.';
      banner.style.display = 'block';
      try { window.Telegram?.WebApp?.HapticFeedback?.impactOccurred('light'); } catch(_){}
      return;
    }

    if (wrong === 0){
      banner.className = 'banner ok';
      banner.textContent = 'Perfect! You nailed it ‚Äî every item is in the right place.';
      banner.style.display = 'block';
      nextBtn.style.display = 'inline-flex';
      checkBtn.style.display = 'none';
      try { window.Telegram?.WebApp?.HapticFeedback?.notificationOccurred('success'); } catch(_){}
      // –∞–≤—Ç–æ—Å–∫—Ä–æ–ª–ª –∫ –±–∞–Ω–Ω–µ—Ä—É
      banner.scrollIntoView({behavior:'smooth', block:'start'});
    } else {
      banner.className = 'banner';
      banner.textContent = 'Not quite ‚Äî the red ones are in the wrong box. Adjust and check again.';
      banner.style.display = 'block';
      try { window.Telegram?.WebApp?.HapticFeedback?.impactOccurred('medium'); } catch(_){}
      banner.scrollIntoView({behavior:'smooth', block:'start'});
    }
  }

  checkBtn.addEventListener('click', check);

  // –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∫—É—Ä—Å–∞
  nextBtn.addEventListener('click', ()=>{
    if (typeof window.pickleNext === 'function') window.pickleNext();
  });
})();
</script>

<!-- –ø—Ä–æ–≥—Ä–µ—Å—Å/–≥–µ–π—Ç–∏–Ω–≥ –¥–ª—è —É—Ä–æ–∫–∞ 3 -->
<script>
(function(){
  const LESSON_ID = 'l3';
  const order = ['l1','l2','l3','l4','l5'];
  const idToIdx = Object.fromEntries(order.map((id,i)=>[id,i]));
  const tg = window.Telegram?.WebApp;

  const fileFor = id => `lesson${id.replace('l','')}.html`;
  const lastId = localStorage.getItem('pickle_progress') || 'l1';
  const hasEmail = !!localStorage.getItem('pickle_email');

  if (!hasEmail) { location.replace('index.html#join'); return; }
  if (idToIdx[LESSON_ID] > idToIdx[lastId]) {
    try{ tg?.HapticFeedback?.impactOccurred('light'); }catch(_){}
    location.replace(fileFor(lastId));
    return;
  }

  window.pickleNext = function(){
    const curIdx = idToIdx[LESSON_ID];
    const savedIdx = idToIdx[localStorage.getItem('pickle_progress') || 'l1'];
    const nextId = order[Math.min(curIdx + 1, order.length - 1)];

    if (curIdx >= savedIdx) {
      localStorage.setItem('pickle_progress', nextId);
      try{ tg?.HapticFeedback?.notificationOccurred('success'); }catch(_){}
    }

    if (curIdx + 1 < order.length) location.href = fileFor(nextId);
    else location.href = 'index.html#breakdown';
  };

  window.pickleBack = function(){ location.href = 'index.html'; };
})();
</script>
</body>
</html>
